<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Moodle Gemini Assistant</title>
    <link rel="stylesheet" href="popup.css">
</head>

<body>
    <div class="container">
        <h2>ğŸ¤– Configuration</h2>

        <!-- Section ClÃ© API -->
        <div class="section">
            <h3>ğŸ”‘ ClÃ© API Gemini</h3>
            <input type="password" id="api-key" placeholder="AIzaSy...">
            <p class="info">
                <a href="https://aistudio.google.com/apikey" target="_blank">
                    Obtenir une clÃ© API
                </a>
            </p>
        </div>

        <!-- Section Mode Examen -->
        <div class="section">
            <h3>ğŸ¯ Mode d'affichage</h3>
            <div class="mode-toggle-container">
                <div class="mode-option" id="mode-normal-option">
                    <span class="mode-icon">ğŸ’¬</span>
                    <span class="mode-label">Mode Normal</span>
                    <span class="mode-desc">Affiche un modal avec la rÃ©ponse et justification</span>
                </div>
                <label class="toggle-switch">
                    <input type="checkbox" id="exam-mode-toggle">
                    <span class="toggle-slider"></span>
                </label>
                <div class="mode-option" id="mode-exam-option">
                    <span class="mode-icon">ğŸ“</span>
                    <span class="mode-label">Mode Examen</span>
                    <span class="mode-desc">Met en Ã©vidence la bonne rÃ©ponse discrÃ¨tement</span>
                </div>
            </div>
            <p class="info" id="current-mode-info">Mode actuel : <strong>Normal</strong></p>
        </div>

        <!-- Section Niveau de RÃ©flexion -->
        <div class="section">
            <h3>ğŸ§  Niveau de RÃ©flexion</h3>
            <p class="info-text">ContrÃ´le la profondeur de raisonnement de l'IA.</p>
            <select id="thinking-level-select" class="select-input">
                <option value="minimal">âš¡ Minimal - Ultra rapide, pas de rÃ©flexion</option>
                <option value="low">ğŸš€ Low - Rapide, rÃ©flexion lÃ©gÃ¨re</option>
                <option value="medium" selected>âš–ï¸ Medium - Ã‰quilibrÃ© (recommandÃ©)</option>
                <option value="high">ğŸ§  High - RÃ©flexion maximale</option>
            </select>
            <p class="info" id="thinking-level-info">
                <strong>Medium</strong> offre un bon Ã©quilibre entre vitesse et qualitÃ©.
            </p>
        </div>

        <!-- Section RAG / Cours -->
        <div class="section">
            <h3>ğŸ“š Cours & Documents (RAG)</h3>

            <div id="rag-status" class="rag-status">
                <span id="status-icon">âšª</span>
                <span id="status-text">Aucun cours indexÃ©</span>
            </div>

            <!-- Pas de cours : afficher sÃ©lection -->
            <div id="no-courses-section">
                <p class="info-text">
                    Ajoutez vos cours (PDF, TXT, MD) pour que l'IA rÃ©ponde Ã  partir de vos documents.
                </p>
                <button id="select-files-btn" class="secondary-btn">
                    ğŸ“ SÃ©lectionner des fichiers
                </button>
            </div>

            <!-- Indexation en cours -->
            <div id="indexing-section" style="display: none;">
                <div class="progress-container">
                    <p id="progress-text">Indexation en cours...</p>
                    <div class="progress-bar">
                        <div id="progress-fill"></div>
                    </div>
                    <p id="progress-details" class="progress-details"></p>
                </div>
            </div>

            <!-- Cours indexÃ©s : afficher liste et actions -->
            <div id="courses-indexed-section" style="display: none;">
                <div class="files-list-container">
                    <ul id="indexed-files-list" class="files-list"></ul>
                    <p id="index-date" class="index-date"></p>
                </div>
                <div class="button-group">
                    <button id="reindex-btn" class="secondary-btn">
                        ğŸ”„ RÃ©indexer
                    </button>
                    <button id="delete-courses-btn" class="danger-btn">
                        ğŸ—‘ï¸ Supprimer
                    </button>
                </div>
            </div>
        </div>

        <!-- Bouton principal -->
        <button id="save-btn" class="save-btn">ğŸ’¾ Enregistrer</button>
        <p id="status" class="status-message"></p>

        <!-- Liens vers les pages de test -->
        <div class="test-link-section">
            <button id="open-test-page-btn" class="test-link-btn">
                ğŸ§ª Ouvrir la page de test RAG
            </button>
            <button id="open-benchmark-page-btn" class="test-link-btn" style="margin-top: 8px;">
                ğŸ“Š Ouvrir la page de Benchmark
            </button>
        </div>
    </div>
    <script src="popup.js"></script>
</body>

</html>